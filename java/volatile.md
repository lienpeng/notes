静态变量 方法区 线程修改可见 非线程安全
实例方法 堆 同一个对象的修改线程可见 非线程安全 不同对象线程安全
局部变量 各自栈帧的工作内存中 线程不共享 线程安全

- 可见性
如果一个线程对共享变量值的修改，能够及时的被其他线程看到，叫做共享变量的可见性。如果一个变量同时在多个线程的工作内存中存在副本，那么这个变量就叫共享变量。

- Java 内存模型规定，将所有的变量都存放在主内存中。
线程对共享变量的所有操作必须在工作内存中进行，不能直接操作主内存。
不同线程间不能访问彼此的工作内存中的变量，线程间变量值的传递都必须经过主内存。

- 要实现共享变量的可见性必须保证下列两点：
线程对工作内存中副本的更改能够及时的更新到主内存上
其他线程能够及时的将主内存上共享变量的更新刷新到自己工作内存的该变量的副本上

以上 对于实例方法的修改，不同线程获取到的值可能不同。

- 特殊操作会从主内存中拉取值
变量被赋值
变量参与计算
线程休眠

- volatile
volatile变量每次被线程访问时，都强迫线程从主内存中重读该变量的最新值，而当该变量发生修改变化时，也会强迫线程将最新的值刷新回主内存。这样一来，不同的线程都能及时的看到该变量的最新值。
volatile不能保证变量更改的原子性

- ThreadLocal
提供线程局部变量；一个线程局部变量在多个线程中，分别有独立的值(副本)。

使用ThreadLocal的好处
达到线程安全
不需要加锁，提高执行效率
更高效地利用内存节省开销，用ThreadLocal可以节省内存和开销。
免去传参的繁琐，不需要每次都传同样的参数，ThreadLocal使得代码耦合度更低，更优雅
