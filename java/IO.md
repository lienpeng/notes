#### 内存分为内核空间和用户空间

- 每个应用程序有单独的用户空间
- 用户态不能访问内核空间中的数据
- 用户态进程必须通过**系统调用** System Call向内核发出指令
- read 和write都是系统调用，涉及到缓冲区，应用程序对socket和文件的IO操作，都是在内核缓冲区和进程缓冲区之间的数据交换

#### IO模型

1. 同步阻塞IO
2. 同步非阻塞IO
   在内核缓冲没有数据的情况下回立刻返回失败，需要用户线程不断请求，一般不会使用
3. IO多路复用

   - 包括select、epoll系统调用，epoll系统调用是在linux 2.6内核提出，是select系统调用的增强
   - IO多路复用模型的优点是一个选择器查询线程可以同时处理成千上万的网络连接，所以用户程序不必创建大量的线程，也不必维护这些线程，从而大大减少了系统的开销。与一个线程维护一个连接的阻塞IO模式相比，这一点是IO多路复用模型的最大优势。
   - 异步IO

#### 文件句柄

文件句柄也叫文件描述符。在Linux系统中，文件可分为普通文件、目录文件、链接文件和设备文件。文件描述符（File Descriptor）是内核为了高效管理已被打开的文件所创建的索引，是一个非负整数（通常是小整数），用于指代被打开的文件。所有的IO系统调用（包括socket的读写调用）都是通过文件描述符完成的。

#### JAVA NIO

1. 通道 channel

   在NIO中，一个网络连接使用一个通道表示，所有NIO的IO操作都是通过连接通道完成的。
2. 选择器

   选择器可以理解为一个IO事件的监听与查询器。通过选择器，一个线程可以查询多个通道的IO事件的就绪状态。

   IO多路复用编程的第一步是把通道注册到选择器中，第二步是通过选择器所提供的事件查询（select）方法来查询这些注册的通道是否有已经就绪的IO事件（例如可读、可写、网络连接完成等）。由于一个选择器只需要一个线程进行监控，因此我们可以很简单地使用一个线程，通过选择器去管理多个连接通道。

   NIO使用选择器的最大优势是系统开销小。系统不必为每一个网络连接（文件描述符）创建进程/线程，从而大大减少了系统的开销。
3. 缓冲区
4. Buffer类

   capacity 内部容量大小

   position 当前位置

   limit 写入或者读取数据的最大上限

   allocate() 获取实例对象 分配内存空间

   put()写入

   flip() 写变为读 clear()或者compact()读变为写

   rewind() 或者mark()+reset() 实现重复读
